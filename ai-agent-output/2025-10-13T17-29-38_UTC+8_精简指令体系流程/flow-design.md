# 流程设计草案

## 1. 文档结构规划
- `AI-AGENT_criterion.md`
  - 前言：任务目标、执行语言、版本信息更新要求。
  - “六环节概览”段落，简述任务前置准备→收尾的主线步骤。
  - “环节关键要求”子章节，分别列出每个环节的操作要点（列表形式，每点≤2行）。
  - “验证与测试要点”区块：针对编程任务列出必运行的验证动作（测试、lint、文档更新）。
  - “MCP 使用速览”矩阵：按环节列出可用 MCP（Sequential Thinking、Serena、Filesystem、Desktop Commander、web-search/Context7），重点说明触发时机，无细节技巧。
  - “模板与参考”段落，指向 `ai-agent-output` 中的标准模板（optimized-task、undetermined 等）。
- `AI-AGENT_step-before.md`
  - 四段结构：任务分析、内容优化、待定项处理、结果生成。
  - 每段维持 3-4 条操作步骤，并附跳转链接指向 `AI-AGENT_criterion.md` 对应小节。
- `AI-AGENT_check.md`
  - 维持“全程通用 + 六环节”框架，删除 user-temp、MCP 日志相关条目。
  - 精简描述，强调“state 更新 + git 提交 + 模板同步”三类动作。
- `undetermined-template.md`
  - 保留评分制、编号规范与示例，仅去除与 user-temp/MCP 日志相关的说明。
- `now-task.md`
  - 保留标题与指导语，说明执行前须先完成任务内容预处理及待定项列举。

## 2. 分析与待定项生成策略
- 在进入主体阶段前，逐一阅读 `src/ai-agent-memo-1` 对应文档，记录需删除或改写的段落。
- 针对每个目标文档形成新的待定项，说明拟保留/删除内容与预计结构调整，提交用户确认后再动手。
- 重点关注以下内容：
  1. user-temp 与 MCP 日志流程的删除点。
  2. general/programming/mcp-rules 之间重复的章节，规划合并方式。
  3. step-before 中的冗长说明与引用同步。

## 3. 执行顺序
1. 研读 `src/ai-agent-memo-1` 现有文档，形成 `ai-agent-memo-2` 各文件的详细蓝图。
2. 汇总需要在 `src/` 目录修改的所有段落，写入新的 `undetermined.md` 条目并请求确认。
3. 获批后创建 `src/ai-agent-memo-2/` 目录与文件，依序编写内容。
4. 同步更新 `src/Agents.md` 或其他引用位置，确保指向新目录；如需保留旧文档链接，提供并行说明。
5. 完成后执行自检：验证所有链接、流程说明与验证标准一致；运行必要测试（若有脚本）。

## 4. 风险与应对
- **双份文档维护风险**：新增目录与旧目录并存，需在新文档开头标注版本区别，避免混淆。
- **指令删减过度**：保留关键核对要点及模板链接，避免失去可执行性；若篇幅缩减后出现理解缺口，追加简明示例。
- **引用失效**：对文档中的所有路径使用相对路径，完成后以 `rg` 检查“user-temp”或“mcp-log”字样，确保已清理。

## 5. 验证计划
- 文档检查：人工校对六环节内容与MCP列表是否覆盖需求。
- 链接校验：使用 `rg "\[.*\]\(.*ai-agent-memo-2"` 检查引用格式是否正确。
- 版本记录：`CHANGELOG.md` 添加新版本条目，说明指令体系重构与旧流程移除。
- Git 状态：每完成一类文档编辑即更新 `AI-AGENT_working-status.csv` 并提交。
