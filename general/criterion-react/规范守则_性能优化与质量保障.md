# 规范守则 - 性能优化与质量保障

## 项目类型
- 对性能、加载速度、体验指标有严格要求的 React(TypeScript) 应用（含Vite、Next.js、CSR/SSR混合模式）。

## 核心原则
### 1. 性能优化
- 组件级优化：合理使用 `React.memo`、`useMemo`、`useCallback`；使用 `useDeferredValue`、`useTransition` 优化交互体验。
- 代码拆分：利用动态导入 (`React.lazy`/`next/dynamic`) 与路由级分片；分析 bundle（`next build --profile`、`rollup-plugin-visualizer`）。
- 静态资源：启用 HTTP/2、压缩（Brotli）、预加载关键资源。
- 渲染策略：根据场景混合 CSR/SSR/ISR；Edge 部署减小延迟。

### 2. 质量保障
- 类型安全：`tsconfig` 启用 `strict`、`noImplicitAny`、`noUncheckedIndexedAccess`。
- Lint：`eslint-plugin-react`、`eslint-plugin-import`、`typescript-eslint`；格式化使用 Prettier。
- 测试体系：单元（Vitest/Jest）、集成（React Testing Library）、E2E（Playwright）；性能（Lighthouse CI）。

### 3. 监控与可观测性
- 前端日志：使用 Sentry、Datadog Browser SDK；捕获Error Boundary信息。
- 性能指标：通过 Web Vitals (`web-vitals`)、`@vercel/analytics` 收集 FCP、LCP、CLS、INP。
- 构建CI检查：`pnpm lint`、`pnpm test`、`pnpm build`、`pnpm vitest --coverage`、`lighthouse-ci`。

## 项目结构示例
```
perf-app/
├── src/
│   ├── main.tsx
│   ├── app/App.tsx
│   ├── components/
│   ├── analytics/
│   └── utils/perfLogger.ts
├── public/
├── vite.config.ts
└── .lighthouserc.json
```

## 参考资料
- [React Performance Optimization Techniques](https://www.freecodecamp.org/news/react-performance-optimization-techniques/)
- [Supercharging React TypeScript Performance](https://dev.to/virajlakshitha/supercharging-react-typescript-performance-optimization-techniques-fci)
- [Vite Performance Guide](https://vitejs.dev/guide/performance.html)
- [Web Vitals Tracking](https://web.dev/vitals/)
- [Stackademic: React Best Practices 2024](https://blog.stackademic.com/7-essential-react-best-practices-for-efficient-code-and-lightning-fast-web-apps-in-2024-d2e909b36706)
